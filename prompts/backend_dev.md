后端开发提示词

角色定位
    你是一位精通Python网络编程和多线程的资深后端开发者，擅长设计高性能的数据传输系统。现在需要为一款名为SendNow的局域网文件传输工具实现全部后端功能，前端UI已完成，需要将其与功能性后端连接。

产品概述    
    SendNow是一款轻量级局域网文件传输工具，具有以下特点：
    无需互联网连接，仅依赖局域网环境
    支持设备自动发现与配对
    支持多种文件类型传输，包括大文件
    强调传输速度和安全性
    基于Python-Qt开发，目标平台为Windows/macOS

技术需求
    1.网络通信模块
        设备发现机制
        实现基于UDP广播的局域网设备自动发现
        每台设备需要有唯一标识符和友好名称
        能够处理设备上线/下线事件
        连接建立
    2.采用TCP Socket实现可靠的文件传输连接
        支持多设备并发连接
        实现简单的握手协议确认连接建立
    3.传输协议设计
        设计自定义应用层协议，包含消息类型、头信息和负载
        支持的消息类型：设备信息请求/响应、文件传输请求/响应、数据包、确认包
        协议应包含校验机制确保数据完整性
    4.文件传输功能
        文件发送功能
        支持选择单个或多个文件发送
        发送前进行文件元数据（文件名、大小、类型等）交换
        采用分块传输方式，支持大文件
    5.文件接收功能
        实现文件接收请求响应机制
        提供接收进度实时反馈
        支持接收完成后的文件完整性校验
        实现文件保存路径配置
    6.传输控制
        支持传输暂停/继续/取消
        实现超时重传机制
        提供传输速度限制选项
多线程与性能优化
多线程架构
采用生产者-消费者模式实现文件传输队列
网络IO与界面更新分离，避免界面卡顿
使用线程池管理多连接场景
性能优化
采用高效的缓冲区管理减少内存占用
实现适应网络状况的动态窗口大小调整
针对不同大小文件采用不同的传输策略
错误处理与安全性
错误恢复机制
实现连接断开自动重连
支持传输中断后的断点续传
提供详细错误日志记录与错误码定义
安全性设计
实现基本的传输加密（可选AES）
提供文件传输授权确认机制
支持接收方对传入连接的控制
接口设计
UI接口集成
以下是需要与前端UI进行交互的关键接口：
设备管理接口
Apply to Backend_dev....
pass
文件发送接口
Apply to Backend_dev....
pass
文件接收接口
Apply to Backend_dev....
pass
数据结构定义
Apply to Backend_dev....
完成时间
协议设计
消息格式
Apply to Backend_dev....
+
消息类型定义
DISCOVER: 设备发现广播
DISCOVER_RESPONSE: 设备发现响应
TRANSFER_REQUEST: 传输请求
TRANSFER_ACCEPT: 接受传输
TRANSFER_REJECT: 拒绝传输
FILE_INFO: 文件信息
DATA: 数据包
ACK: 确认包
COMPLETE: 传输完成
ERROR: 错误信息
实现建议
开发步骤
首先实现基础的网络通信模块，确保设备发现正常工作
实现简单的文件发送和接收功能（小文件）
添加进度反馈和UI更新
实现大文件分块传输
添加错误处理和恢复机制
实现高级功能（断点续传、传输控制等）
性能优化和测试
依赖库建议
socket: 网络通信基础
threading: 多线程支持
select/selectors: 非阻塞IO
hashlib: 文件校验和计算
cryptography: 简单加密支持（可选）
zeroconf: 网络服务发现（可选替代UDP广播）
性能注意事项
避免在UI线程中进行IO操作
大文件传输使用合适的缓冲区大小
根据网络状况动态调整传输参数
定期检查内存使用情况，避免内存泄漏
测试策略
单元测试：针对各个组件的独立测试
集成测试：测试组件间的交互
性能测试：测试不同大小文件的传输性能
故障测试：模拟网络不稳定、断开等场景